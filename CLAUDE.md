# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is a modern blog application built with Next.js 15, Fumadocs MDX, and Tailwind CSS. The blog is content-driven, with MDX files in `blog/content/` that are processed by Fumadocs MDX to generate blog posts with full React component support.

## Development Commands

```bash
# Install dependencies
pnpm install

# Development server (with Turbopack)
pnpm dev

# Production build
pnpm build

# Start production server
pnpm start

# Lint code
pnpm lint
```

## Architecture

### Content System (Fumadocs MDX)

The blog uses Fumadocs MDX for content management:

- **Content location**: `blog/content/` - All blog posts are MDX files here
- **Configuration**: `source.config.ts` - Defines the MDX setup and frontmatter schema
- **Source generation**: The `.source` directory (gitignored) is auto-generated by `fumadocs-mdx` command
- **Frontmatter schema**: Extends base schema with: `date`, `tags`, `featured`, `readTime`, `author`, `thumbnail`

### Data Loading Pattern

The app uses Fumadocs' loader pattern:

```typescript
const blogSource = loader({
  baseUrl: "/blog",
  source: createMDXSource(docs, meta),
});

// Get all pages
const pages = blogSource.getPages();

// Get specific page
const page = blogSource.getPage([slug]);
```

This is used in both `app/page.tsx` (homepage) and `app/blog/[slug]/page.tsx` (individual posts).

### MDX Components

Custom MDX components are defined in `mdx-components.tsx`:

- **Media components**: `MediaViewer`, `ImageViewer`, `VideoViewer`
- **UI components**: `Accordion` components from shadcn/ui
- **Author component**: `<Author id="authorKey" />` - Renders author card in MDX
- **Custom headings**: All h1-h6 tags use `CopyHeader` component for anchor link copying

These components can be used directly in MDX files.

### Author System

Authors are defined in `lib/authors.ts`:

- Add new authors to the `authors` object with keys that match the author field in frontmatter
- Author data includes: `name`, `position`, `avatar`
- Use `getAuthor(key)` to retrieve author data
- Use `isValidAuthor(key)` to check if an author exists

### Site Configuration

Site-wide settings in `lib/site.ts`:

- `name`: Site name
- `url`: Site URL
- `description`: Site description

### Component Structure

- **`components/`**: Reusable React components
  - `blog-card.tsx`: Homepage blog card display
  - `tag-filter.tsx`: Tag filtering UI
  - `table-of-contents.tsx`: Desktop TOC for blog posts
  - `mobile-toc.tsx`: Mobile drawer TOC
  - `author-card.tsx`: Author information display
  - `read-more-section.tsx`: Related articles section
  - `copy-header.tsx`: Headings with copy link functionality
  - `hash-scroll-handler.tsx`: Smooth scroll to hash on page load
  - `ui/`: shadcn/ui components
  - `magicui/`: Magic UI components (e.g., `flickering-grid.tsx`)

### Routing Structure

- `/` - Homepage with blog listing and tag filtering
- `/blog/[slug]` - Individual blog post pages
- `/blog/[slug]/opengraph-image.tsx` - Auto-generated OG images for posts

## Adding Blog Posts

1. Create a new `.mdx` file in `blog/content/`
2. Add frontmatter with required fields:
   ```yaml
   ---
   title: "Post Title"
   description: "Post description"
   date: "2024-12-01"
   tags: ["Tag1", "Tag2"]
   featured: true
   readTime: "10 min read"
   author: "authorKey"
   thumbnail: "/path/to/image.png"
   ---
   ```
3. The post will automatically appear on the homepage
4. Tags are automatically extracted and added to the filter

## Styling

- **Tailwind CSS 4** with custom configuration
- **Theme system**: Uses `next-themes` for dark/light mode
- **Typography**: Geist font family
- **Prose styling**: Blog posts use Tailwind's typography plugin with custom classes in `app/blog/[slug]/page.tsx:120`

## Key Technical Details

- **Next.js 15** with App Router and React Server Components
- **MDX processing**: Fumadocs handles MDX compilation and provides components like `DocsBody`
- **Image optimization**: Uses Next.js `Image` component with `fill` for blog thumbnails
- **Date formatting**: Custom `formatDate` function in both page files (consider extracting to utils)
- **Git-based timestamps**: `lastModifiedTime: "git"` in source config uses git history for modification dates
- **Build process**: `fumadocs-mdx` command generates the `.source` directory before Next.js builds

## Common Tasks

### Adding a new author
1. Add author entry to `lib/authors.ts`
2. Add avatar image to `public/authors/`
3. Reference author by key in blog post frontmatter

### Customizing MDX components
1. Import or create component
2. Add to `getMDXComponents` in `mdx-components.tsx`
3. Use directly in MDX files

### Modifying blog layout
- **Homepage layout**: `app/page.tsx` - Grid layout with filtering
- **Post layout**: `app/blog/[slug]/page.tsx` - Main content + sidebar with TOC and author card

### Working with tags
Tags are automatically extracted from all posts and displayed on the homepage. No manual tag configuration needed.
